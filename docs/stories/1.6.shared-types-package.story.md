# Story 1.6: Shared Types Package

## Status

Draft

## Story

**As a** developer,
**I want** shared TypeScript types and interfaces across frontend and backend,
**so that** I can ensure type safety and consistency across services.

## Acceptance Criteria

1. Shared types package created in packages/shared-types/
2. Common types defined: User, Form, FormSubmission, Pagination, etc.
3. Type definitions match backend C# models
4. Package can be imported by frontend and other TypeScript projects
5. Package published to npm workspace or local package registry
6. Type definitions exported as ES modules
7. Package includes TypeScript declaration files (.d.ts)
8. Package versioning strategy defined
9. Documentation for using shared types
10. CI/CD pipeline validates type consistency

## Tasks / Subtasks

- [ ] Task 1: Create Shared Types Package Structure (AC: 1)
  - [ ] Create packages/shared-types/ directory
  - [ ] Initialize npm/TypeScript package
  - [ ] Set up package.json with proper name and version
  - [ ] Configure TypeScript compiler options
  - [ ] Set up build scripts

- [ ] Task 2: Define Common Types (AC: 2)
  - [ ] Create User type definition
  - [ ] Create Form type definition
  - [ ] Create FormSubmission type definition
  - [ ] Create Pagination types (PaginationRequest, PaginatedResponse)
  - [ ] Create Filter types (FormFilter, SubmissionFilter)
  - [ ] Create DTO types (CreateFormRequest, UpdateFormRequest, etc.)
  - [ ] Create enum types (FormStatus, SubmissionStatus, Role)

- [ ] Task 3: Ensure Type Consistency with Backend (AC: 3)
  - [ ] Review C# models from Auth Service
  - [ ] Review C# models from Form Builder Service
  - [ ] Review C# models from Form Runtime Service
  - [ ] Map C# types to TypeScript types
  - [ ] Ensure property names match (camelCase conversion)
  - [ ] Ensure enum values match

- [ ] Task 4: Configure Package for Import (AC: 4)
  - [ ] Set up package.json exports field
  - [ ] Configure TypeScript module resolution
  - [ ] Set up build output (ES modules, CommonJS)
  - [ ] Test package import in frontend project
  - [ ] Test package import in other TypeScript projects

- [ ] Task 5: Set Up Package Publishing (AC: 5)
  - [ ] Configure npm workspace (if using monorepo)
  - [ ] Set up local package registry or npm link
  - [ ] Create package publishing script
  - [ ] Test package installation

- [ ] Task 6: Export as ES Modules (AC: 6)
  - [ ] Configure TypeScript to output ES modules
  - [ ] Set up proper module exports
  - [ ] Test ES module imports
  - [ ] Ensure tree-shaking support

- [ ] Task 7: Generate TypeScript Declaration Files (AC: 7)
  - [ ] Configure TypeScript to generate .d.ts files
  - [ ] Ensure all types are properly exported
  - [ ] Test type checking with declaration files
  - [ ] Verify IntelliSense works in consuming projects

- [ ] Task 8: Define Versioning Strategy (AC: 8)
  - [ ] Document semantic versioning approach
  - [ ] Set up version bumping script
  - [ ] Define breaking change policy
  - [ ] Create CHANGELOG.md

- [ ] Task 9: Create Documentation (AC: 9)
  - [ ] Write README.md with usage examples
  - [ ] Document all exported types
  - [ ] Provide migration guide for type updates
  - [ ] Add code examples

- [ ] Task 10: Set Up CI/CD Validation (AC: 10)
  - [ ] Add type checking step to CI pipeline
  - [ ] Validate type consistency with backend
  - [ ] Run TypeScript compiler in CI
  - [ ] Fail build on type errors

## Dev Notes

### Previous Story Insights

From Stories 1.2, 1.3, 1.4:
- Auth Service models: User, RefreshToken, Role enum
- Form Builder Service models: Form, AuditLog, FormStatus enum
- Form Runtime Service models: FormSubmission, SubmissionStatus enum
- Common DTOs: PaginationRequest, PaginatedResponse, FilterRequest types

### Data Models

**Type Mapping Strategy:**
- C# `Guid` → TypeScript `string` (UUID format)
- C# `DateTime` → TypeScript `Date` or `string` (ISO 8601)
- C# `Dictionary<string, object>` → TypeScript `Record<string, any>`
- C# `List<T>` → TypeScript `T[]`
- C# enums → TypeScript string union types or enum

**Example Type Definitions:**
```typescript
// User types
export interface User {
  id: string;
  email: string;
  displayName: string;
  roles: Role[];
  tenantId?: string;
  createdAt: Date;
  updatedAt: Date;
}

export enum Role {
  Admin = 'Admin',
  FormBuilder = 'FormBuilder',
  FormUser = 'FormUser',
  Viewer = 'Viewer'
}

// Form types
export interface Form {
  id: string;
  name: string;
  description?: string;
  schema: Record<string, any>;
  version: string;
  status: FormStatus;
  createdBy: string;
  tenantId: string;
  tags: string[];
  category?: string;
  createdAt: Date;
  updatedAt: Date;
}

export enum FormStatus {
  Draft = 'Draft',
  Published = 'Published',
  Archived = 'Archived'
}
```

[Source: docs/architecture.md#data-models]

### File Locations

**Shared Types Package Structure:**
```
packages/shared-types/
├── src/
│   ├── models/
│   │   ├── User.ts
│   │   ├── Form.ts
│   │   └── FormSubmission.ts
│   ├── dtos/
│   │   ├── Pagination.ts
│   │   ├── Filters.ts
│   │   └── Requests.ts
│   ├── enums/
│   │   ├── Role.ts
│   │   ├── FormStatus.ts
│   │   └── SubmissionStatus.ts
│   └── index.ts              # Main export file
├── package.json
├── tsconfig.json
└── README.md
```

[Source: docs/architecture/source-tree.md]

### Technical Constraints

**Technology Stack:**
- TypeScript 5.0+ [Source: docs/architecture/tech-stack.md]
- ES Modules support
- TypeScript declaration files (.d.ts)

**Package Configuration:**
- Package name: `@formxchange/shared-types`
- Module system: ES Modules (ESM)
- Build output: `dist/` directory
- TypeScript target: ES2020 or higher

**Versioning:**
- Follow semantic versioning (semver)
- Major version for breaking changes
- Minor version for new types/features
- Patch version for bug fixes

**Environment Variables Required:**
- None specific to this story

[Source: docs/architecture.md#development-workflow]

## Testing

### Testing Standards

**Test File Location:**
- Type checking: TypeScript compiler validation
- Integration tests: Test type imports in consuming projects

**Testing Frameworks:**
- TypeScript compiler for type checking
- No runtime tests needed (compile-time only)

**Testing Patterns:**
- Validate TypeScript compilation succeeds
- Test type imports in frontend project
- Test type imports in other TypeScript projects
- Validate type consistency with backend models

**Test Coverage Target:** N/A (compile-time validation only)

## Change Log

| Date | Version | Description | Author |
|------|---------|-------------|--------|
| 2025-12-19 | 1.0 | Initial story creation | Bob (Scrum Master) |

## Dev Agent Record

_This section will be populated by the development agent during implementation_

### Agent Model Used

_To be filled by Dev Agent_

### Completion Notes List

_To be filled by Dev Agent_

### File List

_To be filled by Dev Agent - will list all files created/modified during implementation_

## QA Results

_This section will be populated by the QA Agent after review_

